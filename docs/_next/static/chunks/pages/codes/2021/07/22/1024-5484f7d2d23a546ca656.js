_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[61],{"7Q/C":function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/codes/2021/07/22/1024",function(){return e("8wS3")}])},"8wS3":function(t,n,e){"use strict";e.r(n),e.d(n,"default",(function(){return u}));var r=e("rePB"),i=e("Ff2n"),s=(e("q1tI"),e("7ljp")),o=e("3wrV");function a(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?a(Object(e),!0).forEach((function(n){Object(r.a)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var c={};function u(t){var n=t.components,e=Object(i.a)(t,["components"]);return Object(s.a)("wrapper",l(l(l({},c),e),{},{components:n,mdxType:"MDXLayout"}),Object(s.a)("h1",null,"\u5de6\u4fa7\u83dc\u5355\u7684\u540e\u53f0\u7ba1\u7406\u9875\u9762\u5e03\u5c40"),Object(s.a)(o.a,{lan:"ts",code:"\nimport { Menu } from 'antd';\nimport router from 'next/router';\nimport Link from 'next/link';\nimport { useState, useEffect, ReactNode } from 'react';\nimport 'antd/dist/antd.css'\n\nconst { SubMenu } = Menu;\n\nexport interface IMenu {\n\ticon?: string;\n\tlabel: string;\n\tkey: string;\n\turl?: string;\n\tpkey?: string;\n\tchildren?: IMenu[];\n}\n\nexport interface IProps {\n\tchildren: ReactNode;\n\tmenus: IMenu[];\n\ttitle: string;\n\tlogo: string;\n\tleftWidth?: string;\t// \u5de6\u8fb9\u6846\u5bbd\u5ea6,\u5e26\u5355\u4f4d\n\theader: ReactNode;\n\theadHeight?: string;\n}\n\nexport default function Layout({\n\tchildren,\n\tmenus,\n\ttitle,\n\tlogo,\n\tleftWidth,\n\theader,\n\theadHeight\n}: IProps) {\n\tif (!process.browser) {\n\t\treturn <></>;\n\t}\n\tconst [selectedKeys, setselectedKeys] = useState<string[]>([]);\n\tconst [openKeys, setopenKeys] = useState<string[]>([]);\n\tuseEffect(() => {\n\t\tconst name = router.pathname.replace(/[.*]/, '');\n\t\tfunction getkeys(menu: IMenu, openkeys: Set<string>, selectkeys: string[]) {\n\t\t\tif (menu.children) {\n\t\t\t\tmenu.children.forEach((m) => {\n\t\t\t\t\tgetkeys(m, openkeys, selectkeys);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (name.startsWith(menu.url)) {\n\t\t\t\tif (menu.pkey) {\n\t\t\t\t\topenkeys.add(menu.pkey)\n\t\t\t\t}\n\t\t\t\tselectkeys.push(menu.key);\n\t\t\t}\n\t\t}\n\t\tconst [o, s] = menus.reduce(([o, s], c) => {\n\t\t\tgetkeys(c, o, s);\n\t\t\treturn [o, s];\n\t\t}, [new Set<string>(), []] as [Set<string>, string[]]);\n\t\tsetopenKeys(Array.from(o));\n\t\tsetselectedKeys(s);\n\t}, []);\n\tconst left_width = leftWidth || '12.25rem';\n\tconst head_height = headHeight || '3.75rem';\n\treturn <>\n\t\t<div className='layout'>\n\t\t\t<div className='left' >\n\t\t\t\t<div className=\"logo\" >\n\t\t\t\t\t<img className='logoimage' src={logo} alt=\"logo\" />\n\t\t\t\t\t<span className='logotitle'>{title}</span>\n\t\t\t\t</div>\n\t\t\t\t<div className='menu'>\n\t\t\t\t\t<Menu\n\t\t\t\t\t\tstyle={{ overflowY: 'auto' }}\n\t\t\t\t\t\tmultiple={false}\n\t\t\t\t\t\ttheme=\"dark\"\n\t\t\t\t\t\tdefaultSelectedKeys={selectedKeys}\n\t\t\t\t\t\tselectedKeys={selectedKeys}\n\t\t\t\t\t\topenKeys={openKeys}\n\t\t\t\t\t\tonClick={(i) => {\n\t\t\t\t\t\t\tconst [, ...rest] = i.keyPath;\n\t\t\t\t\t\t\tsetselectedKeys([i.key]);\n\t\t\t\t\t\t\tsetopenKeys(rest);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonOpenChange={(keys) => {\n\t\t\t\t\t\t\tsetopenKeys(keys as string[]);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tmode=\"inline\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{menus.map((menu) => {\n\t\t\t\t\t\t\treturn generatemenu(menu);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Menu>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"right\">\n\t\t\t\t<Header height={head_height}>{header}</Header>\n\t\t\t\t<div className='content'>{children}</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<style jsx>{`\n.right{\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex: 1;\n\tmargin-left: ${left_width};\n}\n.menu{\n\toverflow-y:hidden;\n}\n.menu:hover{\n\toverflow: auto;\n}\n.left{\n\tposition: fixed;\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex: 0;\n\tbackground: #050F2A;\n\twidth:${left_width};\n\tmargin: 0;\n\tpadding: 0;\n\tposition: fixed;\n\theight: 100%;\n}\n.layout{\n\tdisplay: flex;\n\theight: 100vh;\n\tflex-direction: row;\n}\n.content{\n\tpadding: 1rem 3rem;\n}\n.logo {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 0.5rem;\n\theight: ${head_height};\n}\n.logoimage{\n\theight: 3rem;\n}\n.logotitle{\n\tcolor:#008cff;\n\tfont-size: 22px;\n\tcursor: pointer;\n}\n`}</style>\n\t</>;\n}\n\n/**\n * \u6839\u636e\u6570\u636e\u521b\u5efa\u83dc\u5355\uff0c\u4f46\u7531\u4e8eantd\u7ec4\u4ef6\u7684bug\u4e0d\u80fd\u4f7f\u7528\u51fd\u6570\u7ec4\u4ef6\n */\nfunction generatemenu(menu: IMenu) {\n\tif (!menu.url || menu.children) {\n\t\treturn <SubMenu key={menu.key} icon={<Icon src={menu.icon} />} title={<span className='menulabel'>{menu.label}</span>}>\n\t\t\t{menu.children.map((m) => {\n\t\t\t\treturn generatemenu(m);\n\t\t\t})}\n\t\t\t<style jsx>{`\n.menulabel{\nfont-size: 1rem;\n}\n`}</style>\n\t\t</SubMenu>;\n\t}\n\treturn <Menu.Item key={menu.key} icon={menu.pkey ? <SubMenuIcon src={menu.icon} /> : <Icon src={menu.icon} />}>\n\t\t<Link href={menu.url}><a><span className={menu.pkey ? 'menulabel2' : 'menulabel'}>{menu.label}</span></a></Link>\n\t\t<style jsx>{`\n.menulabel{\nfont-size: 1rem;\n}\n.menulabel2{\nfont-size: 0.9rem;\n}\n`}</style>\n\t</Menu.Item>;\n}\n\nfunction Icon({ src }: { src: string }) {\n\tif (!src) {\n\t\treturn <></>;\n\t}\n\treturn <>\n\t\t<img className='icon' src={src} />\n\t\t<style jsx>{`\n.icon{\n\twidth: 1.5rem;\n\theight: 1.5rem;\n\tmargin-right: 0.5rem;\n}\n`}</style>\n\t</>;\n}\n\nfunction SubMenuIcon({ src }: { src: string }) {\n\tif (!src) {\n\t\treturn <></>;\n\t}\n\treturn <>\n\t\t<img className='icon' src={src} />\n\t\t<style jsx>{`\n.icon{\n\twidth: 1.1rem;\n\theight: 1.1rem;\n\tmargin-right: 0.5rem;\n}\n`}</style>\n\t</>;\n}\n\nfunction Header({ children, height }: { children: ReactNode; height: string; }) {\n\treturn <Shadow>\n\t\t<div className='c'>{children}</div>\n\t\t<style jsx>{`\n.c{\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tbackground-color: #fff;\n\twidth: 100%;\n\theight: ${height};\n}\n`}</style>\n\t</Shadow>;\n}\n\nfunction Shadow({ children }: { children: ReactNode; }) {\n\treturn <>\n\t\t<div>{children}</div>\n\t\t<style jsx>{`\ndiv{\n\tbox-shadow: 0.2rem 0.2rem 0.3rem #e0e0e0;\n}\n`}</style>\n\t</>;\n}\n",mdxType:"CodeEditor"}),Object(s.a)("h2",null,"\u53c2\u6570"),Object(s.a)("ul",null,Object(s.a)("li",{parentName:"ul"},"children \u53f3\u4fa7\u4e3b\u4f53\u9875\u9762\u5185\u5bb9"),Object(s.a)("li",{parentName:"ul"},"menus \u83dc\u5355\u6570\u636e,\u83dc\u5355\u9875\u9762\u5730\u5740,\u5982\u679c\u662f\u5c42\u7ea7\u7ed3\u6784\u7684\u83dc\u5355,\u9700\u8981\u5b50\u9875\u9762\u5305\u542b\u7236\u9875\u9762\u5730\u5740,\u5373\u5982\u7236\u9875\u9762\u4e3a/home,\u5b50\u9875\u9762\u5fc5\u987b\u4e3a /home/xxx \u4e4b\u7c7b\u7684\u8def\u5f84,\u800c\u5176\u5b83\u5206\u7c7b\u4e0b\u7684\u9875\u9762\u4e0d\u8981\u653e\u7f6e\u5728 /home \u4e0b."),Object(s.a)("li",{parentName:"ul"},"title \u5de6\u4e0a\u89d2\u663e\u793a\u7684\u6587\u672c\u5185\u5bb9"),Object(s.a)("li",{parentName:"ul"},"logo \u5de6\u4e0a\u89d2logo\u56fe\u7247"),Object(s.a)("li",{parentName:"ul"},"header \u53f3\u4fa7\u4e0a\u90e8\u5185\u5bb9"),Object(s.a)("li",{parentName:"ul"},"leftWidth \u5de6\u4fa7\u9762\u677f\u5bbd\u5ea6"),Object(s.a)("li",{parentName:"ul"},"headHeight \u5934\u90e8\u9ad8\u5ea6")),Object(s.a)("h2",null,"\u4f7f\u7528"),Object(s.a)("p",null,"\u60f3\u8981\u8fbe\u5230\u5207\u6362\u9875\u9762\u4e0d\u5237\u65b0,\u9700\u8981\u5c06\u8be5\u7ec4\u4ef6\u7684\u8c03\u7528\u653e\u7f6e\u5728",Object(s.a)("inlineCode",{parentName:"p"},"src/pages/_app.tsx"),"\u4e2d.\u4e00\u4e2a\u5178\u578b\u7684\u4f7f\u7528\u793a\u4f8b\u5982\u4e0b:"),Object(s.a)(o.a,{lan:"ts",code:"\nimport { AppContext, AppInitialProps, NextWebVitalsMetric } from 'next/app';\nimport anylogger from 'anylogger';\nimport '../../styles/globals.css';\nimport '../../styles/vars.css';\nimport MyLayout from './mylayout';\n\nconst logger = anylogger('app');\n\nexport function reportWebVitals(metric: NextWebVitalsMetric) {\n\tlogger.info(metric);\n}\n\nfunction App({ Component, pageProps, router }: AppInitialProps & AppContext) {\n\tconst ispublic = /^/(public001|public002)/.test(router.pathname);\n\tif (ispublic) {\n\t\treturn <Component {...pageProps} />;\n\t}\n\treturn <MyLayout>\n\t\t<Component {...pageProps} />\n\t</MyLayout>;\n}\n\nexport default App;\n",mdxType:"CodeEditor"}))}u.isMDXComponent=!0}},[["7Q/C",0,1,2,3,4,5]]]);